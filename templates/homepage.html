<!DOCTYPE html>
<html lang="en">
    <head>

        <meta charset="UTF-8">
        <title>Duke of Edinburgh Website</title>
        <link rel="stylesheet" href="../static/css/Styling.css">
        <script src="../static/scripts.js"></script>

    </head>

    <body>

        <var id="user" hidden>{{user}}</var>

        <button id="loginButton" class="open-button" onclick=openLogin()>Log in</button>

        <div id="loginPopUp" class="popup">
            <form method="post" class="form-container login-form" action="/login">
                <h1>Log in</h1>

                <p class="error-text" id="login-error">{{login_error}}</p>

                <label for="username">Username</label>
                <input name="username" id="username" class="input-text" required>

                <label for="password">Password </label>
                <input type="password" name="password" id="password" class="input-text" required>

                <p id="register"><a href="../register_page">Register.</a></p>
                <button type="submit" id="LoginSubmitButton" class="btn">Log in</button>
                <button type="button" id="LoginCloseButton" class="btn close" onclick="closeLogin()">Close</button>
            </form>
        </div>

        <div id="signed-in">
            <h1>Welcome {{user.username}}</h1>

            <button id="postButton" class="open-button" onclick=openPost()>Post</button>

            <div id="postPopUp" class="popup">
                <form method="post" class="form-container post-form" action="/add_post">
                    <label for="title">Title</label>
                    <input name="title" id="title" class="input-text" required>

                    <label for="body">Body</label>
                    <br>
                    <textarea rows="10" name="body" id="body" class="input-text body-input" required></textarea>


                    <button type="submit" id="submit-post" class="btn">Submit</button>
                    <button type="button" id="PostCloseButton" class="btn close" onclick="closePost()">Close</button>
                </form>
            </div>
        </div>

        <script>

            console.log("{{user.posts}}");


            var posts = "{{user.posts}}";
            posts = posts.substring(1, posts.length - 1);
            posts = posts.split("Post: ");
            posts.shift()

            console.log(posts);

            for (post in posts) {
                console.log(post)

            }


            function addRow(post) {

                const div = document.createElement('div');

                div.className = 'post';

                div.innerHTML = `
                    <h3 class="post-title">post.title<\h3>
                    <br>
                    <p class="post-body">post.body<\p>
                    <p class="post-time">post.pub_date<\p>
                `;

                document.getElementById('content').appendChild(div);
            }
        </script>
        <script src="../static/check_logged_in.js"></script>

    </body>
</html>